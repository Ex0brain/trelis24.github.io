---
layout: post
title:  "iOS Pentesting Guide - Dynamic analysis (Cycript)"
categories: "iOS"
tags:  iOS pentest cycript
author: Trelis
---

* content
{:toc}

A summary of all the commands and things I do during an iOS application static analysis.




# General commands
## Stack Smashing Protections
IT is a security functionality which loads a known value into the stack just before loading the application variables. This allows to protect the pointer 
		Permet carregar un valor conegut a l'stack abans de carregar les variables d'aplicació. D'aquesta manera és possible detectar i protegir els punters claus i arguments de funcions contra buffers overflows.
		otool -I -v app | grep stack
			stack_chk_fail
			stack_chk_guard
	Automatic Reference Countig (ARC)
		Fa que el compilador gestioni la memòria reduïnt així la possibilitat de que l'aplicació provoqui corrupció de memòria.
		otool -I -v app | grep _objc_
			_objc_retain
			_objc_release
			_objc_storeStrong
			_objc_releaseReturnValue
			_objc_autoreleaseReturnValue
			_objc_retainAutoreleaseReturnValue
	Decrypting iOS Binaries
		otool -arch all -Vl app | grep -A5 LC_ENCRYPT
		Clutch -i -> llista
		Clutch -b id
		Pot ser que surti un error a l'utiltizar clutch si l'aplicació depén d'altres binaris que usen un sistema d'encriptació diferent. Si és així, es poden eliminar, desxifrar l'aplicació i tornar-los a afegir. Sinó s'ha de reinstalar la app.
	Class dump
		Permet obtenir les classes i atributs de l'aplicació

Cycript
	Ver objetos del webview:
		UIApp.keyWindow .recursiveDescription().toString()
	Para acceder a objetos individuales i navegar por los distintos paneles del webview:
		UIApp.windows[0].subviews()[0].subviews()
	Seleccionar un botón:
		var button = UIAppWindows[0].subviews()[0].subviews()[4]
	Para ver la función que usa el objeto:
		var target = button.allTargets().allObjects()[0]
	Para ver la función a la que llama el botón:
		[button actionsForTarget:target forControlEvent:UIControlEventTouchUpInside]
	Seleccinar/veure contingut de les variables:
		target.<nom_variable>
	Llamar funciones
		[target <function>:<atributo>]
	Root view controller
		UIApp.KeyWindows.rootViewController
